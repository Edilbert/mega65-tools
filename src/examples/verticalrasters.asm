

basicheader:
	!word $80a,2020
	!byte $9e,$32,$30,$36,$31,0,0,0

	
main:	
	sei
	lda #$47
	sta $D02f
	lda #$53
	sta $d02f
	lda #65
	sta 0
	lda #0            	; disable screen to show only the border
	sta $d011

	lda $d012
raster_sync:	
	cmp $d012
	beq raster_sync

	;; The following loop takes exactly one raster line at 40.5MHz in PAL
loop:
	jsr triggerdma
	jmp loop
	
triggerdma:	
	lda #0			; make sure F018 list format
	sta $d703
	
	lda #0     		; dma list bank
	sta $d702
	lda #>raster_dmalist
	sta $d701
	lda #<raster_dmalist
	sta $d705
	rts


raster_dmalist
	!byte $81,$ff,$00
	!byte $00 		; COPY
	!16 619 		; DMA transfer is 619 bytes long
	!16 raster_colours	; source address
	!byte $00               ; source bank
	!16 $0020		; destination address
	!byte $1d               ; destination bank + HOLD + IO
	;; unused modulo field
	!16 $0000

raster_colours:
	!8 0,0,0,0,0,0,0,0,0,0,0,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0
	!8 0,0,0,11,11,11,12,12,12,15,15,15,1,1,1,15,15,15,12,12,12,11,11,11,0,0,0
	!8 0,0,0,6,6,6,4,4,4,14,14,14,3,3,3,1,1,1,3,3,3,14,14,14,4,4,4,6,6,6,0,0,0

	
